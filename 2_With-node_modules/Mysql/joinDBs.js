var mysql = require('mysql');
//https://alvarotrigo.com/blog/wait-1-second-javascript/
//https://learnsql.com/cookbook/how-to-create-a-table-with-a-foreign-key-in-sql/ 
function delay(milliseconds){
    return new Promise(resolve => {
        setTimeout(resolve, milliseconds);
    });
}
async function run(){
    console.log("Executed now");
    /*create connection to db server and db mydb*/
    var con = mysql.createConnection({
        host: "localhost",
        user: "RolandBenz",
        password: "Qqr***",
        database: "mydb"
    });
    /*connect to db server and db mydb and left join tables*/
    con.connect(function(err) {
        if (err) throw err;
        var sql = "SELECT users.name AS user, products.name AS favorite FROM users LEFT JOIN products ON users.favorite_product = products.id";
        con.query(sql, function (err, result) {
            if (err) throw err;
            console.log(result);
            /*end connetion to db*/
            con.end(function(err) {
                if (err) {
                return console.log('error:' + err.message);
                }
                console.log('Close the database connection.');
                /*destroy connetion to db server*/
                con.destroy();
            });
        });
    });
    await delay(1000);
    console.log("Executed after 1 seconds wait");
    /*create connection to db server and db mydb*/
    var con1 = mysql.createConnection({
        host: "localhost",
        user: "RolandBenz",
        password: "Qqr***",
        database: "mydb"
    });  
    /*connect to db server and db mydb and right join tables*/
    con1.connect(function(err) {
        if (err) throw err;
        var sql = "SELECT users.name AS user, products.name AS favorite FROM users RIGHT JOIN products ON users.favorite_product = products.id";
        con1.query(sql, function (err, result) {
            if (err) throw err;
            console.log(result);
            /*end connetion to db*/
            con1.end(function(err) {
                if (err) {
                return console.log('error:' + err.message);
                }
                console.log('Close the database connection.');
                /*destroy connetion to db server*/
                con1.destroy();
            });

        });
    });
}
run();
